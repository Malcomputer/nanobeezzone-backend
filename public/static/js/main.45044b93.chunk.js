(this["webpackJsonpnanobeezzone-frontend"]=this["webpackJsonpnanobeezzone-frontend"]||[]).push([[0],{284:function(e,t,n){},287:function(e,t,n){},360:function(e,t,n){},368:function(e,t,n){},369:function(e,t,n){},372:function(e,t,n){},373:function(e,t,n){},374:function(e,t,n){},378:function(e,t,n){},383:function(e,t,n){"use strict";n.r(t);var r=n(1),a=n.n(r),c=n(21),s=n.n(c),o=(n(284),n(285),n(286),n(287),n(33)),i=n(245),u=n(218),l="GET_PROFILE_PICTURE",j="GET_USER_INFO",d="CURRENTUSER",h="REGISTER",m="SETUSER",b="SOCKET",f="LOGOUT",O="LOGIN",p="TOKEN",g={auth:localStorage.getItem(p),currentUser:JSON.parse(localStorage.getItem(d)),messageObj:{messages:[],count:null,statusCode:null},userForProfile:null},x=Object(i.a)(Object(u.devtools)(Object(u.redux)((function(e,t){switch(t.type){case O:return{user:t.payload};case f:return{user:{}};case h:return{};case j:return{userForProfile:t.payload};case l:return{profilePagePicture:t.payload};case m:return localStorage.setItem(p,t.data.accessToken),localStorage.setItem(d,JSON.stringify(t.data)),{currentUser:t.data};case b:return{socket:t.payload};default:return e}}),g))),v=n(27),y=n(54),w=n.p+"static/media/profile-placeholder.6e175a91.png",S=n(420),C=n(417),N=n(423),E="",I=function(e){return fetch("".concat(E,"/user/").concat(e),{headers:{Authorization:"bearer ".concat(localStorage.getItem(p))}}).then((function(e){return e.json()}))},T=n(422),P=n(5);var A=function(e){var t=x((function(e){return e.user})),n=x((function(e){return e.dispatch})),a=Object(r.useState)(null),c=Object(v.a)(a,2),s=c[0],o=c[1];return Object(P.jsx)("div",{className:"uploadPictureFormDiv",children:Object(P.jsxs)("form",{className:"uploadForm",encType:"multipart/form-data",onSubmit:function(r){r.preventDefault(),s&&function(e,t,n){var r=new FormData;return r.append("picture",n),fetch(E+"/users/".concat(t,' + "/picture"'),{method:"PUT",headers:{Authorization:"Bearer "+e},body:r}).then((function(e){return e.json()}))}(t.token,t.username,s).then((function(t){200===t.statusCode&&(e.match.params.username,Date.now(),fetch('"/users/" + username + "/picture" + "?t=" + timestamp',{method:"GET",headers:{"Content-Type":"image/png"}}).then((function(e){return e}))).then((function(e){n({type:l,payload:e.url})}))}))},children:[Object(P.jsx)(T.a,{type:"file",name:"imageInput",accept:"image/jpeg, image/gif, image/png",onChange:function(e){return o(e.target.files[0])},required:!0}),Object(P.jsx)("button",{children:"Upload Image"})]})})},U=n(105),F=n(424);var k=function(e){var t=x((function(e){return e.user})),n=x((function(e){return e.dispatch})),a=Object(r.useState)(!1),c=Object(v.a)(a,2),s=c[0],o=c[1];function i(){var r,a;(r=t.token,a=t.username,fetch("users/"+a,{method:"DELETE",headers:{"Content-Type":"application/json",Authorization:"Bearer "+r}}).then((function(e){return e.json()}))).then((function(t){console.log(t),o(!1),n({type:f}),e.history.push("/")}))}return Object(P.jsxs)("div",{className:"deleteUserWrapper",children:[Object(P.jsx)(U.a,{type:"primary",danger:!0,onClick:function(e){o(!0)},children:"Delete User Account"}),Object(P.jsx)(F.a,{visible:s,onOk:i,onCancel:function(e){return o(!1)},footer:[Object(P.jsx)(U.a,{onClick:function(e){return o(!1)},children:"On Second Thought..."}),Object(P.jsx)(U.a,{type:"primary",danger:!0,onClick:function(e){return i()},children:"Yes, I'm Sure"})],children:"Are You Sure You Wish To Delete This Account? All Information, Likes, and Posts Will Be Lost."})]})},D=n(421);var z=function(e){var t=Object(r.useState)({password:""}),n=Object(v.a)(t,2),a=n[0],c=n[1],s=Object(r.useState)({about:""}),o=Object(v.a)(s,2),i=o[0],u=o[1],l=Object(r.useState)({displayName:""}),d=Object(v.a)(l,2),h=d[0],m=d[1],b=x((function(e){return e.dispatch})),f=x((function(e){return e.user})),O=function(e){var t={};a.password.length>3&&(t=Object.assign(t,a)),i.about.length>1&&(t=Object.assign(t,i)),h.displayName.length>3&&(t=Object.assign(t,h)),console.log(t),function(e,t,n){return fetch(E+"/users/".concat(t),{method:"PATCH",headers:{"Content-Type":"application/json",Authorization:"Bearer "+e},body:JSON.stringify(n)})}(f.token,f.username,t).then((function(e){var t;console.log(e),200===e.status&&(t=f.username,console.log(t),fetch(E/"users/".concat(t)).then((function(e){return e.json()})).catch((function(e){return console.log(e)}))).then((function(e){return b({type:j,payload:e})}))}))};return Object(P.jsx)("div",{className:"UpdateForm",children:Object(P.jsxs)(D.a,{className:"UpdateForm",onFinish:function(e){return O()},children:[Object(P.jsx)(D.a.Item,{label:"password",children:Object(P.jsx)(T.a.Password,{name:"password",onChange:function(e){return c({password:e.target.value})}})}),Object(P.jsx)(D.a.Item,{label:"about",children:Object(P.jsx)(T.a,{name:"about",onChange:function(e){return u({about:e.target.value})}})}),Object(P.jsx)(D.a.Item,{label:"displayName",children:Object(P.jsx)(T.a,{name:"displayName",onChange:function(e){return m({displayName:e.target.value})}})}),Object(P.jsx)(D.a.Item,{children:Object(P.jsx)(U.a,{id:"SubmitButton",type:"primary",htmlType:"submit",children:"Submit"})})]})})},L=n(415),B=n(416),R=n(52),J=n(418);n(360);var G=function(e){var t=Object(o.g)(),n=Object(r.useState)({showDrawer:!1}),a=Object(v.a)(n,2),c=a[0],s=a[1];Object(r.useEffect)((function(){s((function(e){return Object(y.a)(Object(y.a)({},e),{},{showDrawer:!1})}))}),[t]);var i=function(e){return s((function(t){return Object(y.a)(Object(y.a)({},t),{},{showDrawer:e})}))};return Object(P.jsxs)("div",{id:"header",children:[Object(P.jsxs)("div",{id:"header-info",children:[!e.user&&e.title&&Object(P.jsx)("h1",{style:{fontWeight:"bold"},children:e.title}),e.drawer&&Object(P.jsx)("button",{onClick:function(){return i(!c.showDrawer)},children:Object(P.jsx)(L.a,{style:{height:"32px",width:"32px"}})}),e.drawer&&Object(P.jsx)(J.a,{anchor:"left",open:c.showDrawer,onClose:function(){return i(!1)},children:Object(P.jsx)(e.drawer,{})}),e.user&&Object(P.jsx)("img",{style:{height:"50px",width:"50px",margin:"0 5px",borderRadius:"50%"},src:e.user.image||w,alt:e.user.username}),e.user&&Object(P.jsxs)("div",{id:"user-info",children:[Object(P.jsx)("div",{id:"name",children:e.user.name}),Object(P.jsx)("div",{id:"username",children:"@".concat(e.user.username)})]})]}),Object(P.jsx)("div",{id:"header-options",children:e.inDrawer&&Object(P.jsx)(R.b,{to:"/user/".concat(e.user.username),children:Object(P.jsx)(B.a,{})})})]})};var W=function(e){var t=x((function(e){return e.currentUser})),n=Object(r.useState)(t),a=Object(v.a)(n,2),c=a[0],s=c.username,o=c.name,i=c.about,u=c.img,l=c.error,j=a[1];return Object(r.useEffect)((function(){e.match.params.profile!==t.username&&I(e.match.params.profile).then(j)}),[t.username,e.match.params.profile]),Object(P.jsxs)(P.Fragment,{children:[Object(P.jsx)(G,{title:"Profile"}),Object(P.jsx)("div",{className:"userInfoCard",children:Object(P.jsxs)(S.a,{style:{width:"350px",background:"var(--third-color)",border:"transparent",margin:"10px auto"},cover:Object(P.jsx)("img",{alt:"userAvatar",src:u||w}),children:[Object(P.jsx)(S.a.Meta,{title:s,description:o}),404===(null===l||void 0===l?void 0:l.status)?Object(P.jsx)("p",{style:{textAlign:"center"},children:"This user does not exist"}):Object(P.jsx)("p",{style:{textAlign:"center"},children:i||"This User Hasn't Given Us Anything To Put Here!"}),e.match.params.profile===t.username&&Object(P.jsxs)(P.Fragment,{children:[Object(P.jsx)(C.a,{orientation:"left",children:"User Settings"}),Object(P.jsxs)(N.a,{children:[Object(P.jsx)(N.a.Panel,{header:"Upload or Change Profile Image",children:Object(P.jsx)(A,Object(y.a)({},e))},"1"),Object(P.jsx)(N.a.Panel,{header:"Update User Info",children:Object(P.jsx)(z,Object(y.a)({},e))},"2"),Object(P.jsx)(N.a.Panel,{header:"Delete User Account",children:Object(P.jsx)(k,Object(y.a)({},e))},"3")]})]})]})})]})};n(368);var _=function(){var e=x((function(e){return e.currentUser})),t=e.username,n=e.name,r=e.image;return Object(P.jsxs)("div",{id:"drawer",children:[Object(P.jsx)(G,{user:{username:t,name:n,image:r},inDrawer:!0}),Object(P.jsx)("hr",{}),Object(P.jsxs)("ul",{id:"drawer-list",children:[Object(P.jsx)("li",{children:Object(P.jsx)(R.b,{to:"/",children:Object(P.jsx)("span",{children:"Chats"})})}),Object(P.jsx)("li",{children:Object(P.jsx)(R.b,{to:"/friends",children:Object(P.jsx)("span",{children:"Add Friends"})})}),Object(P.jsx)("li",{children:Object(P.jsx)(R.b,{to:"/logout",children:Object(P.jsx)("span",{children:"Logout"})})})]})]})},M=n(147),H=(n(369),n(251)),Z=n.n(H);var Y=function(e){var t=x(),n=t.currentUser,a=n.username,c=n.image,s=t.socket,o=Object(r.useState)({}),i=Object(v.a)(o,2),u=i[0],l=i[1],j=Object(r.useState)([]),d=Object(v.a)(j,2),h=d[0],m=d[1];Object(r.useEffect)((function(){var t,n;Object.entries(u).length<1&&I(e.match.params.profile).then(l),h.length<1&&(t=e.match.params.profile,n=a,fetch("".concat(E,"/message/").concat(t,"/").concat(n),{headers:{Authorization:"bearer ".concat(localStorage.getItem(p))}}).then((function(e){return e.json()}))).then((function(e){e.length<1?m([{text:"No Messages",timestamp:+new Date,type:"notification"}]):m(e)})),Object.entries(u).length<1&&I(e.match.params.profile).then(l);var r=document.getElementsByClassName("react-chat-textarea")[0];return r.addEventListener("keydown",b),function(){r.removeEventListener("keydown",b)}}),[u,e.match.params.profile,h.length,a]),Object(r.useEffect)((function(){s&&s.on("send-message",(function(e){return m((function(t){return[].concat(Object(M.a)(t),[e])}))}))}),[s]);var b=function(e){var t=e.target;"TEXTAREA"===t.nodeName&&(t.style.height="1px",t.style.height="".concat(t.scrollHeight+2,"px"))};return Object(P.jsxs)(P.Fragment,{children:[Object(P.jsx)(G,{user:u}),Object(P.jsx)("div",{id:"chat-view",children:Object(P.jsx)(Z.a,{style:{height:"100%",maxWidth:"unset"},userId:a,onSendMessage:function(t){var n={message_id:"".concat(a,":").concat(e.match.params.profile),author:{username:a,id:a,avatarUrl:c},text:t,receiver:e.match.params.profile,type:"text",timestamp:+new Date};m((function(e){return[].concat(Object(M.a)(e),[n])})),function(e){return fetch("".concat(E,"/message"),{method:"POST",headers:{"Content-Type":"application/json",Authorization:"bearer ".concat(localStorage.getItem(p))},body:JSON.stringify({newMessage:e})}).then((function(e){return e.json()}))}(n).then(console.log)},messages:h.sort((function(e,t){return e.timestamp-t.timestamp}))})})]})};n(372);var K=function(e){var t=Object(r.useState)({}),n=Object(v.a)(t,2),a=n[0],c=n[1];return Object(r.useEffect)((function(){e.user.username?c(e.user):e.user.then(c)}),[e.user]),Object(P.jsxs)("a",{href:"/chat/".concat(a.username),id:"user",children:[!e.drawer&&Object(P.jsx)("img",{id:"user-image",src:a.img?a.img:w,alt:a.username}),Object(P.jsx)("span",{id:"user-name",children:a.name})]})};var q=function(){var e=Object(r.useState)([]),t=Object(v.a)(e,2),n=t[0],a=t[1];return Object(r.useEffect)((function(){n.length<1&&fetch("".concat(E,"/users"),{headers:{Authorization:"bearer ".concat(localStorage.getItem(p))}}).then((function(e){return e.json()})).then(a)}),[n.length]),Object(P.jsxs)(P.Fragment,{children:[Object(P.jsx)(G,{title:"Find Friends"}),Object(P.jsx)("div",{id:"user-list",children:n.map((function(e){return Object(P.jsx)(K,{user:e},e._id)}))})]})};n(373);var X=function(e){return Object(P.jsx)("div",{className:"SOS",children:"Error 404! Page Not Found!  try again"})};var Q=function(){var e=x((function(e){return e.currentUser||{username:"",name:"",img:""}})),t=e.username,n=e.name,a=e.img,c=Object(r.useState)([]),s=Object(v.a)(c,2),i=s[0],u=s[1];return Object(r.useEffect)((function(){var e;i.length<1&&(e=t,fetch("".concat(E,"/messages/").concat(e),{headers:{Authorization:"bearer ".concat(localStorage.getItem(p))}}).then((function(e){return e.json()}))).then((function(e){return u(Array.from(new Set(e.map((function(e){return e.message_id.split(":").filter((function(e){return e!==t}))})).flat())))}))}),[i.length,t]),Object(P.jsxs)("div",{id:"main",children:[Object(P.jsxs)("div",{id:"side-bar",children:[Object(P.jsx)(G,{drawer:_,user:{username:t,name:n,img:a}}),i.map((function(e,t){return Object(P.jsx)(K,{drawer:!0,user:I(e)},t)}))]}),Object(P.jsx)("div",{id:"content",children:Object(P.jsxs)(o.c,{children:[Object(P.jsx)(o.a,{exact:!0,path:"/",render:function(){return Object(P.jsxs)(P.Fragment,{children:[Object(P.jsx)(G,{}),Object(P.jsx)("h1",{children:"Open chat from left column"})]})}}),Object(P.jsx)(o.a,{path:"/settings",render:function(){return Object(P.jsx)("h1",{children:"Settings page"})}}),Object(P.jsx)(o.a,{path:"/friends",component:q}),Object(P.jsx)(o.a,{path:"/user/:profile",component:W}),Object(P.jsx)(o.a,{path:"/chat/:profile",component:Y}),Object(P.jsx)(o.a,{component:X})]})})]})},V=n(120),$=(n(374),n.p+"static/media/logo.e4417bde.png"),ee=n(427),te=n(428),ne=n(419),re=n(430),ae=n(426),ce=n(425);var se=function(){var e=Object(o.f)(),t=x().dispatch,n=Object(r.useState)({username:"",password:"",errors:[],loading:!1}),a=Object(v.a)(n,2),c=a[0],s=a[1],i=c.username,u=c.password,l=c.errors,j=c.loading;Object(r.useEffect)((function(){localStorage.getItem(p)&&e.push("/")}));var d=function(e){s((function(t){return Object(y.a)(Object(y.a)({},t),Object(V.a)({},e.target.name,e.target.value))}))},h=function(e){var t=e.username,n=e.password;return t&&n},b=function(e,t){return(null===e||void 0===e?void 0:e.some((function(e){return e.message.toLowerCase().includes(t)})))?"error":""};return Object(P.jsx)(ee.a,{textAlign:"center",verticalAlign:"middle",className:"login-form",children:Object(P.jsxs)(ee.a.Column,{style:{maxWidth:450},children:[Object(P.jsxs)(te.a,{as:"h1",icon:!0,textAlign:"center",children:[Object(P.jsx)("img",{src:$,alt:"NanoBeezZone",id:"logo"}),"Login to NanoBeezZone"]}),Object(P.jsx)(ne.a,{onSubmit:function(e){e.preventDefault(),h(c)&&(s({errors:[],loading:!0}),function(e,t){return fetch("".concat(E,"/login"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({username:e,password:t})}).then((function(e){return e.json()}))}(c.username,c.password).then((function(e){if(e.error)return s({errors:[{message:e.error.message}]});t({type:m,data:e})})))},size:"large",children:Object(P.jsxs)(re.a,{stacked:!0,children:[Object(P.jsx)(ne.a.Input,{fluid:!0,name:"username",icon:"user",iconPosition:"left",placeholder:"Username",onChange:d,value:i,className:b(l,"username"),type:"text"}),Object(P.jsx)(ne.a.Input,{fluid:!0,name:"password",icon:"lock",iconPosition:"left",placeholder:"Password",onChange:d,value:u,className:b(l,"password"),type:"password"}),Object(P.jsx)(ae.a,{disabled:j,className:j?"loading":"",fluid:!0,size:"large",children:"Submit"})]})}),(null===l||void 0===l?void 0:l.length)>0&&Object(P.jsxs)(ce.a,{error:!0,children:[Object(P.jsx)("h3",{children:"Error"}),function(e){return e.map((function(e,t){return Object(P.jsx)("p",{children:e.message},t)}))}(l)]}),Object(P.jsxs)(ce.a,{children:["Don't have an account? ",Object(P.jsx)(R.b,{to:"/Signup",children:"Signup"})]})]})})};n(378);var oe=function(){var e=Object(o.f)(),t=Object(r.useState)({}),n=Object(v.a)(t,2),a=n[0],c=n[1],s=Object(r.useState)([]),i=Object(v.a)(s,2),u=i[0],l=i[1];Object(r.useEffect)((function(){localStorage.getItem(p)&&e.push("/")}));var j=function(e){var t=e.target;c((function(e){return Object(y.a)(Object(y.a)({},e),{},Object(V.a)({},t.name,t.value))}))},d=function(e,t){return(null===e||void 0===e?void 0:e.some((function(e){return e.message.toLowerCase().includes(t)})))?"error":""};return Object(P.jsx)(ee.a,{textAlign:"center",verticalAlign:"middle",className:"signup-form",children:Object(P.jsxs)(ee.a.Column,{style:{maxWidth:450},children:[Object(P.jsxs)(te.a,{as:"h2",icon:!0,color:"#5B0909",textAlign:"center",children:[Object(P.jsx)("img",{src:$,alt:"NanoBeezZone",id:"logo"}),"Register for NanoBeezZone"]}),Object(P.jsx)(ne.a,{size:"large",onSubmit:function(t){var n,r,c;t.preventDefault(),l((function(){return[]})),a.password===a.passwordConfirmation?(n=a.username,r=a.name,c=a.password,fetch("".concat(E,"/signup"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({username:n,name:r,password:c})}).then((function(e){return e.json()}))).then((function(t){t.error?401===t.error.status&&l((function(e){return[].concat(Object(M.a)(e),[{message:t.error.message}])})):201===t.success.status&&e.push("/login")})):l((function(e){return[].concat(Object(M.a)(e),[{message:"password does not match"}])}))},children:Object(P.jsxs)(re.a,{stacked:!0,children:[Object(P.jsx)(ne.a.Input,{fluid:!0,name:"name",icon:"user",iconPosition:"left",placeholder:"Name",onChange:j,className:d(u,"name"),type:"text"}),Object(P.jsx)(ne.a.Input,{fluid:!0,name:"username",icon:"user",iconPosition:"left",placeholder:"Username",onChange:j,className:d(u,"username"),type:"text"}),Object(P.jsx)(ne.a.Input,{fluid:!0,name:"password",icon:"lock",iconPosition:"left",placeholder:"Password",onChange:j,className:d(u,"password"),type:"password"}),Object(P.jsx)(ne.a.Input,{fluid:!0,name:"passwordConfirmation",icon:"repeat",iconPosition:"left",placeholder:"Password Confirmation",onChange:j,className:d(u,"password"),type:"password"}),Object(P.jsx)(ae.a,{fluid:!0,size:"large",children:"Submit"})]})}),(null===u||void 0===u?void 0:u.length)>0&&Object(P.jsxs)(ce.a,{error:!0,children:[Object(P.jsx)("h3",{children:"Error"}),function(e){return e.map((function(e,t){return Object(P.jsx)("p",{children:e.message},t)}))}(u)]}),Object(P.jsxs)(ce.a,{children:["Already a user? ",Object(P.jsx)(R.b,{to:"/login",children:"Login"})]})]})})};var ie=function(){var e=Object(o.f)();return Object(r.useEffect)((function(){localStorage.removeItem(p),localStorage.removeItem(d),e.push("/login")})),Object(P.jsx)(P.Fragment,{})},ue=n(257);var le=function(e){var t=e.theme,n=Object(o.f)(),a=x(),c=a.auth,s=a.currentUser,i=a.dispatch;return Object(r.useEffect)((function(){document.body.className=t,c||n.push("/login")})),Object(r.useEffect)((function(){if(c){var e=Object(ue.a)("/");e.emit("active-user",s.username),i({type:b,payload:e})}}),[s]),Object(P.jsx)("div",{className:"App",children:Object(P.jsxs)(o.c,{children:[Object(P.jsx)(o.a,{path:"/login",component:se}),Object(P.jsx)(o.a,{path:"/signup",component:oe}),Object(P.jsx)(o.a,{path:"/logout",component:ie}),Object(P.jsx)(o.a,{path:"/",component:Q})]})})},je=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,431)).then((function(t){var n=t.getCLS,r=t.getFID,a=t.getFCP,c=t.getLCP,s=t.getTTFB;n(e),r(e),a(e),c(e),s(e)}))};s.a.render(Object(P.jsx)(a.a.StrictMode,{children:Object(P.jsx)(R.a,{children:Object(P.jsx)(le,{theme:localStorage.getItem("THEME")||"default"})})}),document.getElementById("root")),je()}},[[383,1,2]]]);
//# sourceMappingURL=main.45044b93.chunk.js.map