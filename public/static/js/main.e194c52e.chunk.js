(this["webpackJsonpnanobeezzone-frontend"]=this["webpackJsonpnanobeezzone-frontend"]||[]).push([[0],{264:function(e,t,n){},267:function(e,t,n){},340:function(e,t,n){},348:function(e,t,n){},349:function(e,t,n){},352:function(e,t,n){},353:function(e,t,n){},354:function(e,t,n){},358:function(e,t,n){},359:function(e,t,n){"use strict";n.r(t);var r=n(1),a=n.n(r),c=n(21),s=n.n(c),o=(n(264),n(265),n(266),n(267),n(33)),i=n(229),u=n(202),l="GET_PROFILE_PICTURE",j="GET_USER_INFO",d="CURRENTUSER",h="REGISTER",m="SETUSER",b="LOGOUT",f="LOGIN",O="TOKEN",p={auth:localStorage.getItem(O),currentUser:JSON.parse(localStorage.getItem(d)),messageObj:{messages:[],count:null,statusCode:null},userForProfile:null},g=Object(i.a)(Object(u.devtools)(Object(u.redux)((function(e,t){switch(t.type){case f:return{user:t.payload};case b:return{user:{}};case h:return{};case j:return{userForProfile:t.payload};case l:return{profilePagePicture:t.payload};case m:return localStorage.setItem(O,t.data.accessToken),localStorage.setItem(d,JSON.stringify(t.data)),{currentUser:t.data};default:return e}}),p))),x=n(27),v=n(49),y=n.p+"static/media/profile-placeholder.6e175a91.png",w=n(396),S=n(393),N=n(399),C="https://nanobeezzone.herokuapp.com",I=function(e){return fetch("".concat(C,"/user/").concat(e),{headers:{Authorization:"bearer ".concat(localStorage.getItem(O))}}).then((function(e){return e.json()}))},E=n(398),T=n(5);var P=function(e){var t=g((function(e){return e.user})),n=g((function(e){return e.dispatch})),a=Object(r.useState)(null),c=Object(x.a)(a,2),s=c[0],o=c[1];return Object(T.jsx)("div",{className:"uploadPictureFormDiv",children:Object(T.jsxs)("form",{className:"uploadForm",encType:"multipart/form-data",onSubmit:function(r){r.preventDefault(),s&&function(e,t,n){var r=new FormData;return r.append("picture",n),fetch(C+"/users/".concat(t,' + "/picture"'),{method:"PUT",headers:{Authorization:"Bearer "+e},body:r}).then((function(e){return e.json()}))}(t.token,t.username,s).then((function(t){200===t.statusCode&&(e.match.params.username,Date.now(),fetch(C+'"/users/" + username + "/picture" + "?t=" + timestamp',{method:"GET",headers:{"Content-Type":"image/png"}}).then((function(e){return e}))).then((function(e){n({type:l,payload:e.url})}))}))},children:[Object(T.jsx)(E.a,{type:"file",name:"imageInput",accept:"image/jpeg, image/gif, image/png",onChange:function(e){return o(e.target.files[0])},required:!0}),Object(T.jsx)("button",{children:"Upload Image"})]})})},A=n(93),U=n(400);var F=function(e){var t=g((function(e){return e.user})),n=g((function(e){return e.dispatch})),a=Object(r.useState)(!1),c=Object(x.a)(a,2),s=c[0],o=c[1];function i(){var r,a;(r=t.token,a=t.username,fetch(C+"users/"+a,{method:"DELETE",headers:{"Content-Type":"application/json",Authorization:"Bearer "+r}}).then((function(e){return e.json()}))).then((function(t){console.log(t),o(!1),n({type:b}),e.history.push("/")}))}return Object(T.jsxs)("div",{className:"deleteUserWrapper",children:[Object(T.jsx)(A.a,{type:"primary",danger:!0,onClick:function(e){o(!0)},children:"Delete User Account"}),Object(T.jsx)(U.a,{visible:s,onOk:i,onCancel:function(e){return o(!1)},footer:[Object(T.jsx)(A.a,{onClick:function(e){return o(!1)},children:"On Second Thought..."}),Object(T.jsx)(A.a,{type:"primary",danger:!0,onClick:function(e){return i()},children:"Yes, I'm Sure"})],children:"Are You Sure You Wish To Delete This Account? All Information, Likes, and Posts Will Be Lost."})]})},z=n(397);var D=function(e){var t=Object(r.useState)({password:""}),n=Object(x.a)(t,2),a=n[0],c=n[1],s=Object(r.useState)({about:""}),o=Object(x.a)(s,2),i=o[0],u=o[1],l=Object(r.useState)({displayName:""}),d=Object(x.a)(l,2),h=d[0],m=d[1],b=g((function(e){return e.dispatch})),f=g((function(e){return e.user})),O=function(e){var t={};a.password.length>3&&(t=Object.assign(t,a)),i.about.length>1&&(t=Object.assign(t,i)),h.displayName.length>3&&(t=Object.assign(t,h)),console.log(t),function(e,t,n){return fetch(C+"/users/".concat(t),{method:"PATCH",headers:{"Content-Type":"application/json",Authorization:"Bearer "+e},body:JSON.stringify(n)})}(f.token,f.username,t).then((function(e){var t;console.log(e),200===e.status&&(t=f.username,console.log(t),fetch(C/"users/".concat(t)).then((function(e){return e.json()})).catch((function(e){return console.log(e)}))).then((function(e){return b({type:j,payload:e})}))}))};return Object(T.jsx)("div",{className:"UpdateForm",children:Object(T.jsxs)(z.a,{className:"UpdateForm",onFinish:function(e){return O()},children:[Object(T.jsx)(z.a.Item,{label:"password",children:Object(T.jsx)(E.a.Password,{name:"password",onChange:function(e){return c({password:e.target.value})}})}),Object(T.jsx)(z.a.Item,{label:"about",children:Object(T.jsx)(E.a,{name:"about",onChange:function(e){return u({about:e.target.value})}})}),Object(T.jsx)(z.a.Item,{label:"displayName",children:Object(T.jsx)(E.a,{name:"displayName",onChange:function(e){return m({displayName:e.target.value})}})}),Object(T.jsx)(z.a.Item,{children:Object(T.jsx)(A.a,{id:"SubmitButton",type:"primary",htmlType:"submit",children:"Submit"})})]})})},k=n(391),L=n(392),B=n(47),R=n(394);n(340);var J=function(e){var t=Object(o.g)(),n=Object(r.useState)({showDrawer:!1}),a=Object(x.a)(n,2),c=a[0],s=a[1];Object(r.useEffect)((function(){s((function(e){return Object(v.a)(Object(v.a)({},e),{},{showDrawer:!1})}))}),[t]);var i=function(e){return s((function(t){return Object(v.a)(Object(v.a)({},t),{},{showDrawer:e})}))};return Object(T.jsxs)("div",{id:"header",children:[Object(T.jsxs)("div",{id:"header-info",children:[!e.user&&e.title&&Object(T.jsx)("h1",{style:{fontWeight:"bold"},children:e.title}),e.drawer&&Object(T.jsx)("button",{onClick:function(){return i(!c.showDrawer)},children:Object(T.jsx)(k.a,{style:{height:"32px",width:"32px"}})}),e.drawer&&Object(T.jsx)(R.a,{anchor:"left",open:c.showDrawer,onClose:function(){return i(!1)},children:Object(T.jsx)(e.drawer,{})}),e.user&&Object(T.jsx)("img",{style:{height:"50px",width:"50px",margin:"0 5px",borderRadius:"50%"},src:e.user.image||y,alt:e.user.username}),e.user&&Object(T.jsxs)("div",{id:"user-info",children:[Object(T.jsx)("div",{id:"name",children:e.user.name}),Object(T.jsx)("div",{id:"username",children:"@".concat(e.user.username)})]})]}),Object(T.jsx)("div",{id:"header-options",children:e.inDrawer&&Object(T.jsx)(B.b,{to:"/user/".concat(e.user.username),children:Object(T.jsx)(L.a,{})})})]})};var G=function(e){var t=g((function(e){return e.currentUser})),n=Object(r.useState)(t),a=Object(x.a)(n,2),c=a[0],s=c.username,o=c.name,i=c.about,u=c.img,l=c.error,j=a[1];return Object(r.useEffect)((function(){e.match.params.profile!==t.username&&I(e.match.params.profile).then(j)}),[t.username,e.match.params.profile]),Object(T.jsxs)(T.Fragment,{children:[Object(T.jsx)(J,{title:"Profile"}),Object(T.jsx)("div",{className:"userInfoCard",children:Object(T.jsxs)(w.a,{style:{width:"350px",background:"var(--third-color)",border:"transparent",margin:"10px auto"},cover:Object(T.jsx)("img",{alt:"userAvatar",src:u||y}),children:[Object(T.jsx)(w.a.Meta,{title:s,description:o}),404===(null===l||void 0===l?void 0:l.status)?Object(T.jsx)("p",{style:{textAlign:"center"},children:"This user does not exist"}):Object(T.jsx)("p",{style:{textAlign:"center"},children:i||"This User Hasn't Given Us Anything To Put Here!"}),e.match.params.profile===t.username&&Object(T.jsxs)(T.Fragment,{children:[Object(T.jsx)(S.a,{orientation:"left",children:"User Settings"}),Object(T.jsxs)(N.a,{children:[Object(T.jsx)(N.a.Panel,{header:"Upload or Change Profile Image",children:Object(T.jsx)(P,Object(v.a)({},e))},"1"),Object(T.jsx)(N.a.Panel,{header:"Update User Info",children:Object(T.jsx)(D,Object(v.a)({},e))},"2"),Object(T.jsx)(N.a.Panel,{header:"Delete User Account",children:Object(T.jsx)(F,Object(v.a)({},e))},"3")]})]})]})})]})};n(348);var W=function(){var e=g((function(e){return e.currentUser})),t=e.username,n=e.name,r=e.image;return Object(T.jsxs)("div",{id:"drawer",children:[Object(T.jsx)(J,{user:{username:t,name:n,image:r},inDrawer:!0}),Object(T.jsx)("hr",{}),Object(T.jsxs)("ul",{id:"drawer-list",children:[Object(T.jsx)("li",{children:Object(T.jsx)(B.b,{to:"/",children:Object(T.jsx)("span",{children:"Chats"})})}),Object(T.jsx)("li",{children:Object(T.jsx)(B.b,{to:"/friends",children:Object(T.jsx)("span",{children:"Add Friends"})})}),Object(T.jsx)("li",{children:Object(T.jsx)(B.b,{to:"/logout",children:Object(T.jsx)("span",{children:"Logout"})})})]})]})},_=n(140),M=(n(349),n(235)),H=n.n(M);var Z=function(e){var t=g((function(e){return e.currentUser})),n=t.username,a=t.image,c=Object(r.useState)({}),s=Object(x.a)(c,2),o=s[0],i=s[1],u=Object(r.useState)([]),l=Object(x.a)(u,2),j=l[0],d=l[1];Object(r.useEffect)((function(){var t,r;Object.entries(o).length<1&&I(e.match.params.profile).then(i),j.length<1&&(t=e.match.params.profile,r=n,fetch("".concat(C,"/message/").concat(t,"/").concat(r),{headers:{Authorization:"bearer ".concat(localStorage.getItem(O))}}).then((function(e){return e.json()}))).then((function(e){e.length<1?d([{text:"No Messages",timestamp:+new Date,type:"notification"}]):d(e)})),Object.entries(o).length<1&&I(e.match.params.profile).then(i);var a=document.getElementsByClassName("react-chat-textarea")[0];return a.addEventListener("keydown",h),function(){a.removeEventListener("keydown",h)}}),[o,e.match.params.profile,j.length,n]);var h=function(e){var t=e.target;"TEXTAREA"===t.nodeName&&(t.style.height="1px",t.style.height="".concat(t.scrollHeight+2,"px"))};return Object(T.jsxs)(T.Fragment,{children:[Object(T.jsx)(J,{user:o}),Object(T.jsx)("div",{id:"chat-view",children:Object(T.jsx)(H.a,{style:{height:"100%",maxWidth:"unset"},userId:n,onSendMessage:function(t){var r={message_id:"".concat(n,":").concat(e.match.params.profile),author:{username:n,id:n,avatarUrl:a},text:t,receiver:e.match.params.profile,type:"text",timestamp:+new Date};d((function(e){return[].concat(Object(_.a)(e),[r])})),function(e){return fetch("".concat(C,"/message"),{method:"POST",headers:{"Content-Type":"application/json",Authorization:"bearer ".concat(localStorage.getItem(O))},body:JSON.stringify({newMessage:e})}).then((function(e){return e.json()}))}(r).then(console.log)},messages:j.sort((function(e,t){return e.timestamp-t.timestamp}))})})]})};n(352);var Y=function(e){var t=Object(r.useState)({}),n=Object(x.a)(t,2),a=n[0],c=n[1];return Object(r.useEffect)((function(){e.user.username?c(e.user):e.user.then(c)}),[e.user]),Object(T.jsxs)("a",{href:"/chat/".concat(a.username),id:"user",children:[!e.drawer&&Object(T.jsx)("img",{id:"user-image",src:a.img?a.img:y,alt:a.username}),Object(T.jsx)("span",{id:"user-name",children:a.name})]})};var q=function(){var e=Object(r.useState)([]),t=Object(x.a)(e,2),n=t[0],a=t[1];return Object(r.useEffect)((function(){n.length<1&&fetch("".concat(C,"/users"),{headers:{Authorization:"bearer ".concat(localStorage.getItem(O))}}).then((function(e){return e.json()})).then(a)}),[n.length]),Object(T.jsxs)(T.Fragment,{children:[Object(T.jsx)(J,{title:"Find Friends"}),Object(T.jsx)("div",{id:"user-list",children:n.map((function(e){return Object(T.jsx)(Y,{user:e},e._id)}))})]})};n(353);var K=function(e){return Object(T.jsx)("div",{className:"SOS",children:"Error 404! Page Not Found!  try again"})};var X=function(){var e=g((function(e){return e.currentUser||{username:"",name:"",img:""}})),t=e.username,n=e.name,a=e.img,c=Object(r.useState)([]),s=Object(x.a)(c,2),i=s[0],u=s[1];return Object(r.useEffect)((function(){var e;i.length<1&&(e=t,fetch("".concat(C,"/messages/").concat(e),{headers:{Authorization:"bearer ".concat(localStorage.getItem(O))}}).then((function(e){return e.json()}))).then((function(e){return u(Array.from(new Set(e.map((function(e){return e.message_id.split(":").filter((function(e){return e!==t}))})).flat())))}))}),[i.length,t]),Object(T.jsxs)("div",{id:"main",children:[Object(T.jsxs)("div",{id:"side-bar",children:[Object(T.jsx)(J,{drawer:W,user:{username:t,name:n,img:a}}),i.map((function(e,t){return Object(T.jsx)(Y,{drawer:!0,user:I(e)},t)}))]}),Object(T.jsx)("div",{id:"content",children:Object(T.jsxs)(o.c,{children:[Object(T.jsx)(o.a,{exact:!0,path:"/",render:function(){return Object(T.jsxs)(T.Fragment,{children:[Object(T.jsx)(J,{}),Object(T.jsx)("h1",{children:"Open chat from left column"})]})}}),Object(T.jsx)(o.a,{path:"/settings",render:function(){return Object(T.jsx)("h1",{children:"Settings page"})}}),Object(T.jsx)(o.a,{path:"/friends",component:q}),Object(T.jsx)(o.a,{path:"/user/:profile",component:G}),Object(T.jsx)(o.a,{path:"/chat/:profile",component:Z}),Object(T.jsx)(o.a,{component:K})]})})]})},Q=n(106),V=(n(354),n.p+"static/media/logo.e4417bde.png"),$=n(406),ee=n(404),te=n(395),ne=n(405),re=n(402),ae=n(401);var ce=function(){var e=Object(o.f)(),t=g().dispatch,n=Object(r.useState)({username:"",password:"",errors:[],loading:!1}),a=Object(x.a)(n,2),c=a[0],s=a[1],i=c.username,u=c.password,l=c.errors,j=c.loading;Object(r.useEffect)((function(){localStorage.getItem(O)&&e.push("/")}));var d=function(e){s((function(t){return Object(v.a)(Object(v.a)({},t),Object(Q.a)({},e.target.name,e.target.value))}))},h=function(e){var t=e.username,n=e.password;return t&&n},b=function(e,t){return(null===e||void 0===e?void 0:e.some((function(e){return e.message.toLowerCase().includes(t)})))?"error":""};return Object(T.jsx)($.a,{textAlign:"center",verticalAlign:"middle",className:"login-form",children:Object(T.jsxs)($.a.Column,{style:{maxWidth:450},children:[Object(T.jsxs)(ee.a,{as:"h1",icon:!0,textAlign:"center",children:[Object(T.jsx)("img",{src:V,alt:"NanoBeezZone",id:"logo"}),"Login to NanoBeezZone"]}),Object(T.jsx)(te.a,{onSubmit:function(e){e.preventDefault(),h(c)&&(s({errors:[],loading:!0}),function(e,t){return fetch("".concat(C,"/login"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({username:e,password:t})}).then((function(e){return e.json()}))}(c.username,c.password).then((function(e){if(e.error)return s({errors:[{message:e.error.message}]});t({type:m,data:e})})))},size:"large",children:Object(T.jsxs)(ne.a,{stacked:!0,children:[Object(T.jsx)(te.a.Input,{fluid:!0,name:"username",icon:"user",iconPosition:"left",placeholder:"Username",onChange:d,value:i,className:b(l,"username"),type:"text"}),Object(T.jsx)(te.a.Input,{fluid:!0,name:"password",icon:"lock",iconPosition:"left",placeholder:"Password",onChange:d,value:u,className:b(l,"password"),type:"password"}),Object(T.jsx)(re.a,{disabled:j,className:j?"loading":"",fluid:!0,size:"large",children:"Submit"})]})}),(null===l||void 0===l?void 0:l.length)>0&&Object(T.jsxs)(ae.a,{error:!0,children:[Object(T.jsx)("h3",{children:"Error"}),function(e){return e.map((function(e,t){return Object(T.jsx)("p",{children:e.message},t)}))}(l)]}),Object(T.jsxs)(ae.a,{children:["Don't have an account? ",Object(T.jsx)(B.b,{to:"/Signup",children:"Signup"})]})]})})};n(358);var se=function(){var e=Object(o.f)(),t=Object(r.useState)({}),n=Object(x.a)(t,2),a=n[0],c=n[1],s=Object(r.useState)([]),i=Object(x.a)(s,2),u=i[0],l=i[1];Object(r.useEffect)((function(){localStorage.getItem(O)&&e.push("/")}));var j=function(e){var t=e.target;c((function(e){return Object(v.a)(Object(v.a)({},e),{},Object(Q.a)({},t.name,t.value))}))},d=function(e,t){return(null===e||void 0===e?void 0:e.some((function(e){return e.message.toLowerCase().includes(t)})))?"error":""};return Object(T.jsx)($.a,{textAlign:"center",verticalAlign:"middle",className:"signup-form",children:Object(T.jsxs)($.a.Column,{style:{maxWidth:450},children:[Object(T.jsxs)(ee.a,{as:"h2",icon:!0,color:"#5B0909",textAlign:"center",children:[Object(T.jsx)("img",{src:V,alt:"NanoBeezZone",id:"logo"}),"Register for NanoBeezZone"]}),Object(T.jsx)(te.a,{size:"large",onSubmit:function(t){var n,r,c;t.preventDefault(),l((function(){return[]})),a.password===a.passwordConfirmation?(n=a.username,r=a.name,c=a.password,fetch("".concat(C,"/signup"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({username:n,name:r,password:c})}).then((function(e){return e.json()}))).then((function(t){t.error?401===t.error.status&&l((function(e){return[].concat(Object(_.a)(e),[{message:t.error.message}])})):201===t.success.status&&e.push("/login")})):l((function(e){return[].concat(Object(_.a)(e),[{message:"password does not match"}])}))},children:Object(T.jsxs)(ne.a,{stacked:!0,children:[Object(T.jsx)(te.a.Input,{fluid:!0,name:"name",icon:"user",iconPosition:"left",placeholder:"Name",onChange:j,className:d(u,"name"),type:"text"}),Object(T.jsx)(te.a.Input,{fluid:!0,name:"username",icon:"user",iconPosition:"left",placeholder:"Username",onChange:j,className:d(u,"username"),type:"text"}),Object(T.jsx)(te.a.Input,{fluid:!0,name:"password",icon:"lock",iconPosition:"left",placeholder:"Password",onChange:j,className:d(u,"password"),type:"password"}),Object(T.jsx)(te.a.Input,{fluid:!0,name:"passwordConfirmation",icon:"repeat",iconPosition:"left",placeholder:"Password Confirmation",onChange:j,className:d(u,"password"),type:"password"}),Object(T.jsx)(re.a,{fluid:!0,size:"large",children:"Submit"})]})}),(null===u||void 0===u?void 0:u.length)>0&&Object(T.jsxs)(ae.a,{error:!0,children:[Object(T.jsx)("h3",{children:"Error"}),function(e){return e.map((function(e,t){return Object(T.jsx)("p",{children:e.message},t)}))}(u)]}),Object(T.jsxs)(ae.a,{children:["Already a user? ",Object(T.jsx)(B.b,{to:"/login",children:"Login"})]})]})})};var oe=function(){var e=Object(o.f)();return Object(r.useEffect)((function(){localStorage.removeItem(O),localStorage.removeItem(d),e.push("/login")})),Object(T.jsx)(T.Fragment,{})};var ie=function(e){var t=e.theme,n=Object(o.f)(),a=g().auth;return Object(r.useEffect)((function(){document.body.className=t,a||n.push("/login")})),Object(T.jsx)("div",{className:"App",children:Object(T.jsxs)(o.c,{children:[Object(T.jsx)(o.a,{path:"/login",component:ce}),Object(T.jsx)(o.a,{path:"/signup",component:se}),Object(T.jsx)(o.a,{path:"/logout",component:oe}),Object(T.jsx)(o.a,{path:"/",component:X})]})})},ue=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,407)).then((function(t){var n=t.getCLS,r=t.getFID,a=t.getFCP,c=t.getLCP,s=t.getTTFB;n(e),r(e),a(e),c(e),s(e)}))};s.a.render(Object(T.jsx)(a.a.StrictMode,{children:Object(T.jsx)(B.a,{children:Object(T.jsx)(ie,{theme:localStorage.getItem("THEME")||"default"})})}),document.getElementById("root")),ue()}},[[359,1,2]]]);
//# sourceMappingURL=main.e194c52e.chunk.js.map